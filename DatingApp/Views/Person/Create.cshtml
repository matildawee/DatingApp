@model DataLayer.Models.Person

@{
    ViewData["Title"] = "Profile";
}

<h1>Profile</h1>

<h4>Add your info</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Create">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="FirstName" class="control-label"></label>
                <input asp-for="FirstName" class="form-control" />
                <span asp-validation-for="FirstName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="LastName" class="control-label"></label>
                <input asp-for="LastName" class="form-control" />
                <span asp-validation-for="LastName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Description" class="control-label"></label>
                <input asp-for="Description" class="form-control" />
                <span asp-validation-for="Description" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Picture" class="control-label"></label>
                <input asp-for="Picture" class="form-control" />
                <span asp-validation-for="Picture" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input id="create" type="submit" value="Save" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<div>
    <a asp-action="Index">Back to List</a>
</div>

@section Scripts {

    <script>
      $(() =>
         $("#create").click((e) => {
            // preventDefault på eventet ser till att knappens egna submit inte triggas. För annars görs ett anrop till servern som laddar om sidan när den hittar en view med matchande route.
            e.preventDefault();
            //var name = $("#name").val();
            //var birthDate = $("#birthDate").val();
            //var superPower = $("#superPower").val();

            // jquery post anropar ajax men med försatta värden. Bland annat var det fel contentType så $.ajax måste användas istället och speca värdena själv.
            // JSON.stringify måste också användas för att få rätt encoding på data som skickas.

            $.ajax({
               url: "/api/superhero/sendmessage",
               type: "POST",
               data: JSON.stringify({ text: "meddelande" }),
               contentType: "application/json; charset=utf-8",
               dataType: "json",
               success: alert("sent")
            });

            //$.post("/api/superhero/sendmessage", {text: "meddelande"})
            //   .then((result) => alert(result))
         })
      );
    </script>

    <partial name="_ValidationScriptsPartial" />
}